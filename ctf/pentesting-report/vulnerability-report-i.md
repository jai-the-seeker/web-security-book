---
description: CTF Blackbox testing of "foomegahost.com"
---

# Vulnerability Report - I

## Vulnerability report

### Information Gathering

Information gathering is a critical step in the reconnaissance phase of any security assessment, as it allows for the identification of potential attack vectors and vulnerabilities that an attacker may leverage. It helps security professionals to understand the target system, its configuration, and services running on it, thereby enabling them to design an effective security strategy.

#### Nmap Scan

`Nmap` is a powerful open-source network scanner used for network exploration, management, and security auditing. It is capable of discovering hosts and services on a network, mapping network topology, and identifying potential security threats. `Nmap` offers various scanning techniques, such as ping scans, port scans, and version detection, making it an essential tool for network enumeration and reconnaissance. The screenshot of the `Nmap` results is as given below:

<figure><img src="../../.gitbook/assets/image (18).png" alt=""><figcaption><p>Nmap Scan results</p></figcaption></figure>

#### Analysis of the scan results

Port `53`: This port is open and runs `Microsoft DNS 6.1.7601 (1DB14556)` on `Windows Server 2008 R2 SP1`.

Port `80`: This port is open and runs `Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)`. Potentially risky methods like `TRACE` and disallowed entries in robots.txt for `/ws/` and `/ws/service.wsdl` were found. This could indicate a vulnerability that allows for unauthorized access or information disclosure.

Port `3389`: This port is open and runs `ssl/ms-wbt-server`. The SSL certificate is not valid before `2023-04-07T18:24:04` and not valid after `2023-10-07T18:24:04`. This could indicate a vulnerability that allows for man-in-the-middle attacks or other types of SSL-related attacks. Additionally, the `RDP-NTLM-Info` provides information about the computer, domain name, product version, and system time, which could be used in an attack.

Port `49155`: This port is open and runs Microsoft Windows RPC. No vulnerabilities were identified for this port.

### SubDomain Enumeration

Subdomain enumeration is the process of discovering subdomains for a given domain name. This technique is often used by security professionals to identify potential attack surfaces and to find new targets for reconnaissance and exploitation. A number of tools were used in the process. The relevant screenshots are given below:

#### Fierce

`Fierce` is a subdomain enumeration tool that uses a dictionary attack to discover subdomains. It is known for its speed and effectiveness in finding subdomains for a target domain. However, we were not successful in using it. In the next subsection, we will investigate the error using the `dig` command.

<figure><img src="../../.gitbook/assets/image (19).png" alt=""><figcaption><p>Fierce subdomain enumeration tool</p></figcaption></figure>

#### Dig Command

`Dig` is a command-line tool that can be used to perform DNS lookups and discover subdomains. It is a standard utility in most Linux distributions and can be used to perform advanced DNS queries. The screenshots are given below:

<figure><img src="../../.gitbook/assets/image (20).png" alt="" width="375"><figcaption><p>Dig Command</p></figcaption></figure>

To trace the DNS resolution process for the **`foomegahost.com`** domain, we used the command **`dig +trace foomegahost.com`**. This command allows us to see the entire path taken by the DNS queries made to resolve the domain name. We can see each DNS server that was queried, as well as the responses received from each server. This information is useful for troubleshooting DNS issues, as it can help identify where in the resolution process a problem may be occurring.

<figure><img src="../../.gitbook/assets/image (21).png" alt="" width="375"><figcaption><p>Dig command</p></figcaption></figure>

**Analysis**: After running the **`dig`** command, it seems that the DNS server at **`foomegahost.com`** is returning a **`FORMERR`** status, indicating a format error in the DNS query. This error is preventing us from using the `fierce` tool for subdomain enumeration.

#### [Subbrute.py](http://subbrute.py)

`subbrute.py` is a Python-based subdomain enumeration tool that uses a brute-force approach to discover subdomains. It uses a large list of words and phrases to generate a comprehensive list of subdomains for a given domain name.

<figure><img src="../../.gitbook/assets/image (22).png" alt=""><figcaption><p>Subbrute Command</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (23).png" alt="" width="375"><figcaption><p>Subbrute Results</p></figcaption></figure>

#### wfuzz

`wfuzz`is a web application security testing tool that can also be used for subdomain enumeration. It is a popular tool among security professionals due to its flexibility and advanced features. `wfuzz` uses a variety of techniques to discover subdomains, including brute-force attacks and dictionary attacks.

<figure><img src="../../.gitbook/assets/image (24).png" alt=""><figcaption><p>Wfuzz</p></figcaption></figure>

#### Conclusion

During the subdomain enumeration phase, two additional subdomains were discovered: `m` and `me`. Subdomain enumeration is a process used by security professionals to identify potential attack surfaces and to find new targets for reconnaissance and exploitation. Several tools were used in the process, including `fierce`, `Dig`, `subbrute.py`, and `wfuzz`.

### Enumerating Directories and Pages

Enumerating directories and pages is an important step in web application testing, as it helps to identify hidden or vulnerable areas of the website that can be targeted by attackers. By discovering these directories and pages, security testers can uncover potential security risks and take steps to mitigate them.

#### Dirbuster

`dirbuster` is a popular tool used for directory enumeration in web application testing. It works by brute-forcing common directory and file names and can be configured to use different wordlists and extensions. `dirbuster` can help to identify hidden or restricted directories and pages, as well as common vulnerabilities such as directory traversal attacks. The `dirbuster` results for `foomegahost.com`are given below:

```clojure
DirBuster 1.0-RC1 - Report
<http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project>
Report produced on Sat Apr 08 23:09:10 EDT 2023
--------------------------------
<http://foomegahost.com:80>
--------------------------------
Directories found during testing:
Dirs found with a 403 response:
/img/
/js/
/img/facilities/
/img/slide/
/img/icons_features/
/img/sponsors/
/img/users/
/js/nav/
/css/
/js/fancybox/
/img/servers/
/js/totop/
/js/efect_switcher/
/include/
/js/slide/
/img/team/
/img/slide/slides/
/img/social/
/css/fonts/
/css/slide/

Dirs found with a 200 response:
/
--------------------------------
Files found during testing:

Files found with a 200 responce:

/contact.php
/about.php
/index.php
/promotions.php
/shared_hosting.php
/virtual_servers.php
/dedicated_servers.php
/js/nav/tinynav.js
/js/nav/superfish.js
/js/jquery-1.8.3.min.js
/js/nav/jquery.sticky.js
/js/fancybox/jquery.fancybox-1.3.1.js
/js/totop/jquery.ui.totop.js
/js/efect_switcher/jquery.content-panel-switcher.js
/js/bootstrap.js
/js/jquery-func.js
/include/get_visitor.php
/js/slide/camera.js
/include/header.php
/include/nav.php
/include/scripts.php
/include/footer.php
/include/sponsor.php
/include/config.php
/include/connect.php

Files found with a 302 responce:

/include/login.php

--------------------------------
```

`m.foomegahost.com`

<figure><img src="../../.gitbook/assets/image (27).png" alt="" width="375"><figcaption><p>Dirbuster GUI tool</p></figcaption></figure>

```clojure

DirBuster 1.0-RC1 - Report
<http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project>
Report produced on Mon Apr 10 08:00:35 EDT 2023
--------------------------------

<http://m.foomegahost.com:80>
--------------------------------
Directories found during testing:

Dirs found with a 200 response:

/
/ws/

Dirs found with a 403 response:

/img/
/js/
/css/
/css/fonts/
/css/slide/
/css/bootstrap/

--------------------------------
Files found during testing:

Files found with a 200 responce:

/index.html
/js/core.js
/js/jquery-1.8.3.min.js
/js/jquery.xml2json.js
/ws/index.php
/ws/config.php

--------------------------------
```

During the directory enumeration phase, the `Dirbuster` tool was used to identify directories and files on the `foomegahost.com` and `m.foomegahost.com` domains. The results of the `Dirbuster` scan showed several directories and files that were accessible on the server. For `m.foomegahost.com`, there were two directories found with a 200 response: `/` and `/ws/`.

### Web Vulnerability Scanning

Web vulnerability scanning is the process of identifying security flaws in web applications using automated tools. It is a crucial step in ensuring the security of web applications and preventing potential cyber attacks. `Nikto`, `ZAP (Zed Attack Proxy)`, and `Burp Suite` are some of the popular tools used for web vulnerability scanning.

#### Nikto Scan

`Nikto` is an open-source web server scanner designed to identify potential vulnerabilities and security weaknesses in web applications. It performs a comprehensive analysis of a website and its web server, including common vulnerabilities such as outdated software, misconfigurations, and insecure server settings. `Nikto` is widely used by security professionals to assess the security posture of web applications and identify potential attack vectors. The screenshots of scan results of `Nikto` are given below:

`http://foomegahost.com`

<figure><img src="../../.gitbook/assets/image (29).png" alt=""><figcaption><p>Nikto scan : foomegahost.com</p></figcaption></figure>

`http://me.foomegahost.com`

<figure><img src="../../.gitbook/assets/image (30).png" alt=""><figcaption><p>Nikto scan : me.foomegahost.com</p></figcaption></figure>



This scan results by `Nikto` shows a few vulnerabilities and potential security issues that can be addressed:

1. Missing `X-Frame-Options` header: The anti-clickjacking `X-Frame-Options` header is not present on the root directory (`"/"`), which can allow an attacker to use the site in a clickjacking attack.
2. Missing `X-Content-Type-Options` header: The `X-Content-Type-Options` header is not set, which could allow the user agent to render the content of the site in a different fashion to the MIME type, potentially exposing it to cross-site scripting (XSS) attacks.
3. Insecure `PHPSESSID` cookie: The `PHPSESSID` cookie is created without the `httponly` flag, which makes it vulnerable to XSS attacks. This flag helps to prevent client-side scripts from accessing the cookie, which can contain sensitive information.

Overall, the scan report indicates that the server is running `Microsoft IIS 7.5` and has a few security issues that can be addressed to improve its security posture.

#### ZAP

The `ZAP scan` has detected that the URL `http://m.foomegahost.com/ws/service.wsdl` exposes services that should only be available for testing purposes and should not be exposed to the world in the production website. The report notes the detection of a `WSDL file` and recommends limiting its visibility to testing purposes only. The report also references two OWASP vulnerabilities related to security misconfigurations: OWASP\_2021\_A05 and OWASP\_2017\_A06. These vulnerabilities can lead to a variety of security risks, including unauthorized access and information disclosure. It is recommended that the misconfigurations be addressed promptly to mitigate potential risks to the organization's security posture.

<figure><img src="../../.gitbook/assets/image (31).png" alt=""><figcaption><p>ZAP Scan</p></figcaption></figure>

### BruteForce Attack

We will attempt a brute force attack on the login page of `me.foomegahost.com`. The results of the brute force attack reveal the username `test` and password `password1234`.

<figure><img src="../../.gitbook/assets/image (32).png" alt=""><figcaption><p>Landing Page of me.foomegahost.com</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (34).png" alt=""><figcaption><p>Bruteforce password using wfuzz</p></figcaption></figure>

### SQL Injection

SQL injection is a type of web application vulnerability that allows an attacker to execute malicious SQL statements to gain unauthorized access to a database.

#### SQLMap

`SQLMap` is a powerful open-source tool used to detect and exploit SQL injection flaws in web applications. It automates the process of identifying SQL injection vulnerabilities and exploiting them to extract sensitive data from the database.

The results of the SQL injection using `SQLMap` are provided below. However, neither webpage was found to be susceptible to SQL injection attacks.

`me.foomegahost.com/include/login.php`

<figure><img src="../../.gitbook/assets/image (1).png" alt=""><figcaption><p>Capture POST request in a .txt file</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (1) (1).png" alt=""><figcaption><p>Sqlmap tool</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (2).png" alt=""><figcaption><p>Sqlmap tool : output</p></figcaption></figure>

`m.foomegahost.com/ws/`

<figure><img src="../../.gitbook/assets/image (3).png" alt=""><figcaption><p>Capture POST request in a .txt file</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (4).png" alt=""><figcaption><p>Sqlmap tool : output</p></figcaption></figure>

### Service.wsdl

During the web vulnerability scanning phase, it was identified that the `service.wsdl` endpoint was accessible to the world in the production environment. This endpoint is used to expose services that should only be available for testing purposes. This vulnerability can lead to a variety of security risks, including unauthorized access and information disclosure, especially if the endpoint is used for SOAP services. Attackers can use this information to craft malicious requests, which can exploit vulnerabilities in the web application and compromise its security. It is recommended to limit the visibility of such endpoints in the production environment and ensure that they are only accessible to authorized users. Proper access controls should be implemented to prevent unauthorized access to these endpoints. The screenshot is given below:

<figure><img src="../../.gitbook/assets/image (5).png" alt=""><figcaption><p>Expose wsdl service</p></figcaption></figure>

#### SQL Injection

We will now check if the elements of the exposed service are vulnerable to SQL injection attacks. We will study the request in Burp.

<figure><img src="../../.gitbook/assets/image (6).png" alt=""><figcaption><p>Capture request in Burp suite</p></figcaption></figure>

Now, we will run the `SQLMap` against the vulnerable elements.

<figure><img src="../../.gitbook/assets/image (7).png" alt=""><figcaption><p>Sqlmap tool</p></figcaption></figure>

The `POST` request is given in the `request-ID.txt` file.

<figure><img src="../../.gitbook/assets/image (8).png" alt=""><figcaption><p>Capture the POST request in a .txt file</p></figcaption></figure>

The following databases and tables are exposed due to the SQL injection Vulnerability.

<figure><img src="../../.gitbook/assets/image (9).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (10).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (11).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

Payloads for which the `ticketID` is vulnerable are given below:

<figure><img src="../../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

Crackstation can be used to find the plain text of the password for the `test` user. We confirm that it is same `password1234` as was discovered in the bruteforce attack section. Other hash cracking tools like `Hashcat` and `Jhon the Ripper` can also be used to crack the hashes.

<figure><img src="../../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dfeecd1e-feb9-4fb1-8cec-e31f230813fe/Untitled.png)

Now, we will check if other elements are also vulnerable to the SQL injection attacks. We, did not find other elements to be susceptible to the attack.

<figure><img src="../../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>
